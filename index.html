let rating = 0;
let selectedOptions = [];

function setRating(stars) {
    rating = stars;
    updateStarsUI();
    generateReview();
}

function updateStarsUI() {
    const stars = document.querySelectorAll('.rating span');
    stars.forEach((star, index) => {
        if (index < rating) {
            star.classList.add('active');
        } else {
            star.classList.remove('active');
        }
    });
}

function toggleOption(element) {
    element.classList.toggle('selected');
    if (element.classList.contains('selected')) {
        selectedOptions.push(element.innerText);
    } else {
        selectedOptions = selectedOptions.filter(opt => opt !== element.innerText);
    }
    generateReview();
}

function generateReview() {
    if (!rating) return;

    let review = '';

    // Star-based narrative
    if (rating === 5) {
        review += "Absolutely fantastic experience! ";
    } else if (rating === 4) {
        review += "Great experience overall. ";
    } else if (rating === 3) {
        review += "It was okay, could be better. ";
    } else if (rating === 2) {
        review += "Not very satisfied, expected more. ";
    } else {
        review += "Terrible experience. I do not recommend. ";
    }

    // Selected highlights
    if (selectedOptions.length) {
        review += "Highlights: " + selectedOptions.join(', ') + ". ";
    }

    // Ending comment based on rating
    if (rating >= 4) {
        review += "Highly recommend!";
    } else if (rating === 3) {
        review += "Could improve next time.";
    } else {
        review += "Needs serious improvement.";
    }

    // Update textarea
    const reviewBox = document.getElementById('review-text');
    reviewBox.value = review;
    reviewBox.style.height = 'auto';
    reviewBox.style.height = reviewBox.scrollHeight + "px";
}

function submitReview() {
    const googleReviewLink = 'YOUR_GOOGLE_REVIEW_LINK';
    window.open(googleReviewLink, '_blank');
}
